import java.sql.*;

public class ArticleDAO {

    public void ajouterArticle(Article article) {
        String query = "INSERT INTO article (nom, marque, prix_unitaire, prix_vrac, quantite_vrac, stock) VALUES (?, ?, ?, ?, ?, ?)";

        try (Connection conn = DatabaseConnection.getConnection();
             PreparedStatement ps = conn.prepareStatement(query)) {

            ps.setString(1, article.getNom());
            ps.setString(2, article.getMarque());
            ps.setDouble(3, article.getPrixUnitaire());
            ps.setDouble(4, article.getPrixVrac());
            ps.setInt(5, article.getQuantiteVrac());
            ps.setInt(6, article.getStock());
            ps.executeUpdate();

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }

    public Article getArticleById(int id) {
        String query = "SELECT * FROM article WHERE id = ?";
        Article article = null;

        try (Connection conn = DatabaseConnection.getConnection();
             PreparedStatement ps = conn.prepareStatement(query)) {

            ps.setInt(1, id);
            ResultSet rs = ps.executeQuery();

            if (rs.next()) {
                article = new Article(
                    rs.getInt("id"),
                    rs.getString("nom"),
                    rs.getString("marque"),
                    rs.getDouble("prix_unitaire"),
                    rs.getDouble("prix_vrac"),
                    rs.getInt("quantite_vrac"),
                    rs.getInt("stock")
                );
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }

        return article;
    }

    public void mettreAJourStock(int idArticle, int nouveauStock) {
        String query = "UPDATE article SET stock = ? WHERE id = ?";

        try (Connection conn = DatabaseConnection.getConnection();
             PreparedStatement ps = conn.prepareStatement(query)) {

            ps.setInt(1, nouveauStock);
            ps.setInt(2, idArticle);
            ps.executeUpdate();

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}
